# コンポーネント別リファクタリング計画

**プロジェクト:** Hidearea Design System Tokens
**日付:** 2025-12-09
**ステータス:** 計画フェーズ

---

## 概要

このドキュメントは、デザイントークンシステムの各コンポーネントに対する詳細なリファクタリング計画を概説します。各コンポーネントは、包括的レビューレポートで定義された段階的アプローチに従って、個別のPRで対処されます。

---

## フェーズ1: 基盤 (第1-2週)

### PR #1: Base/Colors - 欠落しているグレーシェードを追加

**優先度:** 重要
**見積もり工数:** 2時間
**破壊的変更:** なし

#### 現状
- `aliases.json`が`gray.25`、`gray.750`、`gray.950`を参照
- これらのトークンは`base/colors.yaml`に存在しない
- ビルドで壊れた参照を引き起こす

#### 変更内容
`src/base/colors.yaml`に追加:
```yaml
gray:
  25:
    value: "#fcfcfc"
    comment: "ほぼ白に近いグレー - 微細な背景の区別に使用"
  # ... 既存のシェード ...
  750:
    value: "#3a3a3a"
    comment: "濃いグレー - ダークモードの中間色"
  950:
    value: "#0a0a0a"
    comment: "ほぼ黒に近いグレー - ダークモードの最暗背景"
```

#### テスト
- [ ] ビルドがエラーなしで成功
- [ ] CSS出力に新しいトークンが含まれる
- [ ] 出力に壊れた参照がない
- [ ] 型定義が生成される

---

### PR #2: Build - ファイル形式の標準化 (JSON to YAML)

**優先度:** 重要
**見積もり工数:** 4時間
**破壊的変更:** なし (出力は変更なし)

#### 現状
- ベーストークン: YAML
- セマンティックトークン: JSON
- テーマ: YAML
- 一貫性のないコメント機能

#### 変更内容

1. セマンティックJSONファイルをYAMLに変換:
   - `src/semantic/colors.json` → `colors.yaml`
   - `src/semantic/typography.json` → `typography.yaml`
   - `src/semantic/components.json` → `components.yaml`
   - `src/semantic/surfaces.json` → `surfaces.yaml`
   - `src/semantic/states.json` → `states.yaml`
   - `src/semantic/layout.json` → `layout.yaml`
   - `src/semantic/interactions.json` → `interactions.yaml`
   - `src/semantic/aliases.json` → `aliases.yaml`

2. `config.mjs`を更新:
   ```javascript
   source: [
     'src/base/**/*.yaml',
     'src/semantic/**/*.yaml',
     'src/themes/**/*.yaml'
   ]
   ```

3. 全てのトークンに包括的なコメントを追加

#### 移行スクリプト
```javascript
// scripts/json-to-yaml.mjs
import fs from 'fs';
import path from 'path';
import YAML from 'yaml';

const files = [
  'src/semantic/colors.json',
  'src/semantic/typography.json',
  'src/semantic/components.json',
  'src/semantic/surfaces.json',
  'src/semantic/states.json',
  'src/semantic/layout.json',
  'src/semantic/interactions.json',
  'src/semantic/aliases.json'
];

files.forEach(file => {
  const json = JSON.parse(fs.readFileSync(file, 'utf8'));
  const yamlPath = file.replace('.json', '.yaml');
  fs.writeFileSync(yamlPath, YAML.stringify(json, { indent: 2 }));
  fs.unlinkSync(file); // 古いJSONファイルを削除
  console.log(`Converted ${file} to ${yamlPath}`);
});
```

#### テスト
- [ ] 全てのトークンが正常に変換
- [ ] ビルド出力が変更なし (CSS/JSファイルをdiff)
- [ ] トークンの欠落なし
- [ ] コメントが保持/追加される

---

### PR #3: Semantic - トークン参照の修正

**優先度:** 重要
**見積もり工数:** 3時間
**破壊的変更:** なし

#### 現状
- 参照での`.value`サフィックスの使用が不整合
- 例: `{color.white.value}` vs `{color.white}`
- コントリビューターにとって混乱

#### 変更内容

1. 全てのテーマファイルから`.value`サフィックスを削除:

**変更前:**
```yaml
theme:
  light:
    background:
      primary:
        value: "{color.white.value}"
```

**変更後:**
```yaml
theme:
  light:
    background:
      primary:
        value: "{color.white}"
```

2. 更新するファイル:
   - `src/themes/light/colors.yaml`
   - `src/themes/dark/colors.yaml`

3. 将来の問題をキャッチする検証トランスフォームを追加:
```javascript
// config.mjsに追加
StyleDictionary.registerTransform({
  name: 'validate/no-value-suffix',
  type: 'value',
  matcher: (token) => typeof token.value === 'string',
  transformer: (token) => {
    if (token.value.includes('.value}')) {
      throw new Error(
        `Token ${token.path.join('.')} に.valueサフィックスが含まれています: ${token.value}`
      );
    }
    return token.value;
  }
});
```

#### テスト
- [ ] 全ての参照が検証済み
- [ ] ビルドが成功
- [ ] 出力が変更なし
- [ ] 検証が新しい問題をキャッチ

---

### PR #4: Theme - ダークモード強化の追加

**優先度:** 高
**見積もり工数:** 4時間
**破壊的変更:** なし (追加のみ)

#### 現状
- 色のみがテーマ化されている
- ダークモードのシャドウが明るすぎる
- ダークモード用の立体サーフェスがない

#### 変更内容

1. `src/themes/dark/colors.yaml`にシャドウオーバーライドを追加:
```yaml
theme:
  dark:
    # ... 既存の色 ...

    # シャドウ（暗い背景での視認性のためより濃く）
    shadow:
      sm:
        value: "0 1px 2px 0 rgba(0, 0, 0, 0.5)"
        comment: "小さな影 - ダークモード用"
      base:
        value: "0 1px 3px 0 rgba(0, 0, 0, 0.5), 0 1px 2px -1px rgba(0, 0, 0, 0.5)"
      md:
        value: "0 4px 6px -1px rgba(0, 0, 0, 0.5), 0 2px 4px -2px rgba(0, 0, 0, 0.5)"
      lg:
        value: "0 10px 15px -3px rgba(0, 0, 0, 0.5), 0 4px 6px -4px rgba(0, 0, 0, 0.5)"
      xl:
        value: "0 20px 25px -5px rgba(0, 0, 0, 0.5), 0 8px 10px -6px rgba(0, 0, 0, 0.5)"
      "2xl":
        value: "0 25px 50px -12px rgba(0, 0, 0, 0.5)"
```

2. 立体サーフェスを追加:
```yaml
theme:
  dark:
    surface:
      elevated:
        value: "{color.gray.800}"
        comment: "カードやモーダルなどの浮いた要素の背景"
      overlay:
        value: "{color.gray.750}"
        comment: "オーバーレイ要素の背景"
```

#### テスト
- [ ] ダークモードのシャドウが見える
- [ ] 立体サーフェスが区別できる
- [ ] 視覚的リグレッションなし
- [ ] ライトテーマが変更なし

---

## フェーズ2: セマンティック層の強化 (第3-6週)

### PR #5: Semantic/Colors - クリーンアップと強化

**優先度:** 高
**見積もり工数:** 3時間
**破壊的変更:** あり (`neutral`エイリアスを削除)

#### 現在の問題
- `neutral`は`gray`と冗長
- `secondary`は`gray`にマップ (`purple`であるべき)
- アクションカラーが欠落
- フィードバックカラーが欠落

#### 変更内容

1. `src/semantic/colors.yaml`から`neutral`エイリアスを削除:
```yaml
# これを削除:
# neutral:
#   50: { value: "{color.gray.50}" }
#   ...
```

2. `secondary`マッピングを修正:
```yaml
color:
  secondary:
    50: { value: "{color.purple.50}" }
    100: { value: "{color.purple.100}" }
    # ... 全てのpurpleシェード
```

3. アクションカラーを追加:
```yaml
color:
  action:
    primary:
      value: "{color.primary.500}"
      comment: "主要なアクション（ボタン、リンクなど）"
    secondary:
      value: "{color.secondary.500}"
      comment: "二次的なアクション"
    destructive:
      value: "{color.error.500}"
      comment: "破壊的なアクション（削除など）"
    subtle:
      value: "{color.gray.700}"
      comment: "控えめなアクション（キャンセルなど）"
```

4. フィードバックカラーを追加:
```yaml
color:
  feedback:
    success:
      value: "{color.success.500}"
      comment: "成功メッセージ"
    warning:
      value: "{color.warning.500}"
      comment: "警告メッセージ"
    error:
      value: "{color.error.500}"
      comment: "エラーメッセージ"
    info:
      value: "{color.info.500}"
      comment: "情報メッセージ"
```

#### 移行ガイド
```markdown
**破壊的変更:**
- `color.neutral.*`を削除 → 代わりに`color.gray.*`を使用
- `color.secondary.*`が現在purpleにマップ → ニュートラルなセカンダリカラーには`color.gray.*`を使用

**移行:**
```diff
- var(--color-neutral-500)
+ var(--color-gray-500)

- var(--color-secondary-500)  /* グレーが必要な場合 */
+ var(--color-gray-500)

- var(--color-secondary-500)  /* パープルが必要な場合 */
+ var(--color-secondary-500)  /* 変更不要 */
```
```

#### テスト
- [ ] ビルドが成功
- [ ] 全ての新しいトークンが出力に含まれる
- [ ] 削除されたトークンが出力に含まれない
- [ ] ドキュメントが更新される

---

### PR #6: Semantic/Typography - レスポンシブトークンの追加

**優先度:** 高
**見積もり工数:** 4時間
**破壊的変更:** なし (追加のみ)

#### 現在の問題
- レスポンシブタイポグラフィがない
- テキストスタイル間で一貫性のない構造
- 一部のスタイルに`fontFamily`が欠落
- リンクのvisited色がブランドのpurpleと競合

#### 変更内容

1. レスポンシブ見出しトークンを追加:
```yaml
text:
  heading:
    h1:
      fontSize:
        mobile:
          value: "{font.size.2xl}"
          comment: "モバイル: 24px"
        tablet:
          value: "{font.size.3xl}"
          comment: "タブレット: 30px"
        desktop:
          value: "{font.size.4xl}"
          comment: "デスクトップ: 36px"
      fontWeight: { value: "{font.weight.bold}" }
      lineHeight: { value: "{font.lineHeight.tight}" }
      fontFamily: { value: "{font.family.sans}" }
      color: { value: "{color.gray.900}" }

    h2:
      fontSize:
        mobile: { value: "{font.size.xl}" }
        tablet: { value: "{font.size.2xl}" }
        desktop: { value: "{font.size.3xl}" }
      fontWeight: { value: "{font.weight.bold}" }
      lineHeight: { value: "{font.lineHeight.tight}" }
      fontFamily: { value: "{font.family.sans}" }
      color: { value: "{color.gray.900}" }

    # ... h3-h6も同様のパターン
```

2. 完全なプロパティで全てのテキストスタイルを標準化:
```yaml
text:
  body:
    large:
      fontSize: { value: "{font.size.lg}" }
      fontWeight: { value: "{font.weight.normal}" }
      lineHeight: { value: "{font.lineHeight.relaxed}" }
      fontFamily: { value: "{font.family.sans}" }
      color: { value: "{color.gray.700}" }
```

3. リンクのvisited色を修正:
```yaml
text:
  link:
    visited:
      color: { value: "{color.primary.800}" }  # purpleの代わりに濃いプライマリ
```

4. コードブロックでセマンティックトークンを使用:
```yaml
text:
  code:
    inline:
      fontSize: { value: "{font.size.sm}" }
      fontFamily: { value: "{font.family.mono}" }
      background: { value: "{surface.raised.background}" }
      color: { value: "{color.foreground.primary}" }
      padding: { value: "{spacing.1} {spacing.2}" }
      borderRadius: { value: "{border.radius.sm}" }

    block:
      fontSize: { value: "{font.size.sm}" }
      fontFamily: { value: "{font.family.mono}" }
      background: { value: "{color.gray.900}" }
      color: { value: "{color.gray.100}" }
      padding: { value: "{spacing.4}" }
      borderRadius: { value: "{border.radius.md}" }
```

#### 使用例
```css
/* CSS */
.heading-1 {
  font-size: var(--text-heading-h1-font-size-mobile);
}

@media (min-width: 768px) {
  .heading-1 {
    font-size: var(--text-heading-h1-font-size-tablet);
  }
}

@media (min-width: 1024px) {
  .heading-1 {
    font-size: var(--text-heading-h1-font-size-desktop);
  }
}
```

#### テスト
- [ ] 全てのテキストスタイルが完全なプロパティを持つ
- [ ] レスポンシブトークンが正しく生成される
- [ ] コードブロックがセマンティックトークンを使用
- [ ] リンク色が両テーマでアクセシブル

---

### PR #7: Semantic/Surfaces - グラスモーフィズムの追加

**優先度:** 中
**見積もり工数:** 3時間
**破壊的変更:** なし

#### 変更内容

1. リテラル値をトークン参照に変換:
```yaml
surface:
  sunken:
    background: { value: "{color.gray.50}" }
    elevation: { value: "{shadow.inner}" }  # リテラルの代わりにトークンを使用
```

2. グラスモーフィズムトークンを追加:
```yaml
surface:
  glass:
    light:
      background:
        value: "rgba(255, 255, 255, 0.8)"
        comment: "半透明な白背景"
      backdropFilter:
        value: "blur(10px) saturate(180%)"
        comment: "背景ブラー効果"
      border:
        value: "1px solid rgba(255, 255, 255, 0.3)"
        comment: "控えめなボーダー"

    dark:
      background:
        value: "rgba(23, 23, 23, 0.8)"
        comment: "半透明な黒背景"
      backdropFilter:
        value: "blur(10px) saturate(180%)"
        comment: "背景ブラー効果"
      border:
        value: "1px solid rgba(255, 255, 255, 0.1)"
        comment: "控えめなボーダー"
```

#### テスト
- [ ] グラス効果が正しくレンダリング
- [ ] クロスブラウザ互換性
- [ ] パフォーマンスが許容範囲

---

### PR #8: Semantic/States - Focus Visibleの追加

**優先度:** 高 (アクセシビリティ)
**見積もり工数:** 3時間
**破壊的変更:** なし

#### 変更内容

1. フォーカストークンをフラット化して拡張:
```yaml
state:
  focus:
    outline:
      value: "2px solid {color.primary.500}"
      comment: "フォーカス時のアウトライン"
    outlineOffset:
      value: "2px"
      comment: "アウトラインのオフセット"
    ring:
      color: { value: "{color.primary.500}" }
      width: { value: "2px" }
      offset: { value: "2px" }
      style: { value: "solid" }

  focusVisible:
    outline:
      value: "2px solid {color.primary.500}"
      comment: "キーボードフォーカス時のみ表示"
    outlineOffset:
      value: "2px"
```

2. pressed状態を追加:
```yaml
state:
  pressed:
    scale: { value: "0.95" }
    opacity: { value: "0.9" }
    transition: { value: "{interaction.transition.fast}" }
```

3. ローディングアニメーション参照を追加:
```yaml
state:
  loading:
    opacity: { value: "0.6" }
    cursor: { value: "wait" }
    animation:
      name: { value: "pulse" }
      duration: { value: "{animation.duration.slow}" }
      timing: { value: "{animation.easing.easeInOut}" }
      iteration: { value: "infinite" }
```

#### テスト
- [ ] focus visibleがキーボードのみで動作
- [ ] pressed状態がスムーズにアニメーション
- [ ] ローディングアニメーションが正しくループ

---

### PR #9: Semantic/Layout - セーフエリアの追加

**優先度:** 中
**見積もり工数:** 2時間
**破壊的変更:** なし

#### 変更内容

1. レスポンシブ命名をブレークポイントと整合:
```yaml
layout:
  container:
    padding:
      sm: { value: "{spacing.4}" }   # 640px
      md: { value: "{spacing.6}" }   # 768px
      lg: { value: "{spacing.8}" }   # 1024px
      xl: { value: "{spacing.12}" }  # 1280px
```

2. セーフエリアインセットを追加:
```yaml
layout:
  safeArea:
    top:
      value: "env(safe-area-inset-top, 0)"
      comment: "デバイスの上部セーフエリア（ノッチ対応）"
    right:
      value: "env(safe-area-inset-right, 0)"
      comment: "デバイスの右部セーフエリア"
    bottom:
      value: "env(safe-area-inset-bottom, 0)"
      comment: "デバイスの下部セーフエリア（ホームインジケーター対応）"
    left:
      value: "env(safe-area-inset-left, 0)"
      comment: "デバイスの左部セーフエリア"
```

3. flexbox gapトークンを追加:
```yaml
layout:
  gap:
    xs: { value: "{spacing.1}" }
    sm: { value: "{spacing.2}" }
    md: { value: "{spacing.4}" }
    lg: { value: "{spacing.6}" }
    xl: { value: "{spacing.8}" }
```

#### テスト
- [ ] セーフエリアがiOSデバイスで動作
- [ ] gapトークンが正しく適用される

---

### PR #10: Semantic/Interactions - アニメーションの完成

**優先度:** 中
**見積もり工数:** 4時間
**破壊的変更:** なし

#### 変更内容

1. キーフレーム定義を追加:
```yaml
interaction:
  keyframes:
    fadeIn:
      value: |
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
      comment: "フェードイン"

    fadeOut:
      value: |
        @keyframes fadeOut {
          from { opacity: 1; }
          to { opacity: 0; }
        }

    slideInUp:
      value: |
        @keyframes slideInUp {
          from {
            transform: translateY(20px);
            opacity: 0;
          }
          to {
            transform: translateY(0);
            opacity: 1;
          }
        }

    slideInDown:
      value: |
        @keyframes slideInDown {
          from {
            transform: translateY(-20px);
            opacity: 0;
          }
          to {
            transform: translateY(0);
            opacity: 1;
          }
        }

    scaleIn:
      value: |
        @keyframes scaleIn {
          from {
            transform: scale(0.9);
            opacity: 0;
          }
          to {
            transform: scale(1);
            opacity: 1;
          }
        }

    pulse:
      value: |
        @keyframes pulse {
          0%, 100% { opacity: 1; }
          50% { opacity: 0.5; }
        }

    spin:
      value: |
        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
```

2. 完全なアニメーション定義:
```yaml
interaction:
  animation:
    fadeIn:
      keyframes: { value: "fadeIn" }
      duration: { value: "{animation.duration.base}" }
      timing: { value: "{animation.easing.easeIn}" }
      fillMode: { value: "forwards" }

    fadeOut:
      keyframes: { value: "fadeOut" }
      duration: { value: "{animation.duration.base}" }
      timing: { value: "{animation.easing.easeOut}" }
      fillMode: { value: "forwards" }

    # ... 等
```

3. ユーティリティインタラクショントークンを追加:
```yaml
interaction:
  scrollBehavior:
    smooth:
      value: "smooth"
      comment: "スムーズスクロール"
    auto:
      value: "auto"
      comment: "通常のスクロール"

  userSelect:
    none:
      value: "none"
      comment: "選択不可"
    text:
      value: "text"
      comment: "テキスト選択可"
    all:
      value: "all"
      comment: "全選択"

  pointerEvents:
    auto:
      value: "auto"
      comment: "通常のポインタイベント"
    none:
      value: "none"
      comment: "ポインタイベント無効"
```

#### テスト
- [ ] 全てのアニメーションが正しく再生
- [ ] キーフレームがCSSに生成される
- [ ] パフォーマンス問題なし

---

## フェーズ3: コンポーネントトークン (第7-13週)

### コンポーネントファイル構造

Phase 3では、コンポーネントトークンを以下のディレクトリ構造で管理します：

```
src/semantic/components/
├── buttons/
│   └── button.yaml           # ボタンコンポーネント
├── forms/
│   ├── input.yaml            # テキスト入力
│   ├── textarea.yaml         # テキストエリア
│   ├── select.yaml           # セレクトボックス
│   ├── checkbox.yaml         # チェックボックス
│   ├── radio.yaml            # ラジオボタン
│   └── switch.yaml           # スイッチ
├── feedback/
│   ├── alert.yaml            # アラート
│   ├── toast.yaml            # トースト通知
│   ├── badge.yaml            # バッジ
│   ├── tooltip.yaml          # ツールチップ
│   └── progress.yaml         # プログレスバー
├── navigation/
│   ├── navigation.yaml       # ナビゲーション
│   ├── tabs.yaml             # タブ
│   ├── breadcrumb.yaml       # パンくずリスト
│   └── pagination.yaml       # ページネーション
├── overlays/
│   ├── modal.yaml            # モーダル
│   ├── dialog.yaml           # ダイアログ
│   ├── drawer.yaml           # ドロワー
│   ├── popover.yaml          # ポップオーバー
│   └── dropdown.yaml         # ドロップダウン
└── data-display/
    ├── table.yaml            # テーブル
    ├── list.yaml             # リスト
    ├── card.yaml             # カード
    └── avatar.yaml           # アバター
```

**config.mjsの更新が必要:**
```javascript
source: [
  'src/base/**/*.yaml',
  'src/semantic/*.yaml',
  'src/semantic/components/**/*.yaml',  // ← 追加
  'src/themes/**/*.yaml'
],
```

### コンポーネントトークン構造テンプレート

各コンポーネントは以下の包括的な構造に従うべきです:

```yaml
component:
  {componentName}:
    # サイジング
    size:
      small: { ... }
      medium: { ... }
      large: { ... }

    # スペーシング
    padding:
      x: { ... }
      y: { ... }
    gap: { ... }

    # タイポグラフィ
    fontSize: { ... }
    fontWeight: { ... }
    lineHeight: { ... }

    # 各バリアントの色
    {variant}:
      background:
        default: { ... }
        hover: { ... }
        focus: { ... }
        active: { ... }
        disabled: { ... }
      text:
        default: { ... }
        disabled: { ... }
      border:
        default: { ... }
        hover: { ... }
        focus: { ... }
        active: { ... }
        disabled: { ... }
      shadow:
        default: { ... }
        hover: { ... }
        focus: { ... }

    # アニメーション
    transition:
      duration: { ... }
      timing: { ... }
      properties: { ... }
```

---

### PR #11: Component/Button - 完全強化

**優先度:** 重要 (最も使用されるコンポーネント)
**見積もり工数:** 6時間
**破壊的変更:** なし (追加のみ)

#### 現在のトークン
- 4バリアントをカバーする24トークン
- 欠落: サイズ、フォーカス状態、ローディング、アイコン

#### 提案される構造

```yaml
component:
  button:
    # サイズバリアント
    size:
      small:
        height: { value: "{spacing.8}", comment: "32px" }
        paddingX: { value: "{spacing.3}", comment: "12px" }
        paddingY: { value: "{spacing.2}", comment: "8px" }
        fontSize: { value: "{font.size.sm}", comment: "14px" }
        iconSize: { value: "{spacing.4}", comment: "16px" }
        gap: { value: "{spacing.2}", comment: "8px" }

      medium:
        height: { value: "{spacing.10}", comment: "40px" }
        paddingX: { value: "{spacing.4}", comment: "16px" }
        paddingY: { value: "{spacing.2.5}", comment: "10px" }
        fontSize: { value: "{font.size.base}", comment: "16px" }
        iconSize: { value: "{spacing.5}", comment: "20px" }
        gap: { value: "{spacing.2}", comment: "8px" }

      large:
        height: { value: "{spacing.12}", comment: "48px" }
        paddingX: { value: "{spacing.6}", comment: "24px" }
        paddingY: { value: "{spacing.3}", comment: "12px" }
        fontSize: { value: "{font.size.lg}", comment: "18px" }
        iconSize: { value: "{spacing.6}", comment: "24px" }
        gap: { value: "{spacing.3}", comment: "12px" }

    # 共通プロパティ
    fontWeight: { value: "{font.weight.medium}" }
    lineHeight: { value: "{font.lineHeight.none}" }
    borderRadius: { value: "{border.radius.md}" }
    borderWidth: { value: "{border.width.1}" }

    # トランジション
    transition:
      duration: { value: "{animation.duration.fast}" }
      timing: { value: "{animation.easing.ease}" }
      properties: { value: "background-color, border-color, color, box-shadow, transform" }

    # プライマリバリアント (既存を維持 + 新規追加)
    primary:
      background:
        default: { value: "{color.primary.500}" }
        hover: { value: "{color.primary.600}" }
        focus: { value: "{color.primary.600}" }
        active: { value: "{color.primary.700}" }
        disabled: { value: "{color.gray.300}" }
      text:
        default: { value: "{color.white}" }
        disabled: { value: "{color.gray.500}" }
      border:
        default: { value: "{color.primary.500}" }
        hover: { value: "{color.primary.600}" }
        focus: { value: "{color.primary.600}" }
        active: { value: "{color.primary.700}" }
        disabled: { value: "{color.gray.300}" }
      shadow:
        default: { value: "none" }
        hover: { value: "{shadow.sm}" }
        focus: { value: "0 0 0 3px {color.primary.100}" }
        active: { value: "none" }

    # セカンダリバリアント (既存を維持 + 新規追加)
    secondary:
      background:
        default: { value: "transparent" }
        hover: { value: "{color.gray.100}" }
        focus: { value: "{color.gray.100}" }
        active: { value: "{color.gray.200}" }
        disabled: { value: "transparent" }
      text:
        default: { value: "{color.gray.700}" }
        disabled: { value: "{color.gray.400}" }
      border:
        default: { value: "{color.gray.300}" }
        hover: { value: "{color.gray.400}" }
        focus: { value: "{color.gray.400}" }
        active: { value: "{color.gray.500}" }
        disabled: { value: "{color.gray.200}" }
      shadow:
        default: { value: "none" }
        hover: { value: "none" }
        focus: { value: "0 0 0 3px {color.gray.100}" }
        active: { value: "none" }

    # ゴーストバリアント (既存を維持 + 新規追加)
    ghost:
      background:
        default: { value: "transparent" }
        hover: { value: "{color.gray.100}" }
        focus: { value: "{color.gray.100}" }
        active: { value: "{color.gray.200}" }
        disabled: { value: "transparent" }
      text:
        default: { value: "{color.gray.700}" }
        disabled: { value: "{color.gray.400}" }
      border:
        default: { value: "transparent" }
        hover: { value: "transparent" }
        focus: { value: "transparent" }
        active: { value: "transparent" }
        disabled: { value: "transparent" }
      shadow:
        default: { value: "none" }
        hover: { value: "none" }
        focus: { value: "0 0 0 3px {color.gray.100}" }
        active: { value: "none" }

    # デンジャーバリアント (既存を維持 + 新規追加)
    danger:
      background:
        default: { value: "{color.error.500}" }
        hover: { value: "{color.error.600}" }
        focus: { value: "{color.error.600}" }
        active: { value: "{color.error.700}" }
        disabled: { value: "{color.gray.300}" }
      text:
        default: { value: "{color.white}" }
        disabled: { value: "{color.gray.500}" }
      border:
        default: { value: "{color.error.500}" }
        hover: { value: "{color.error.600}" }
        focus: { value: "{color.error.600}" }
        active: { value: "{color.error.700}" }
        disabled: { value: "{color.gray.300}" }
      shadow:
        default: { value: "none" }
        hover: { value: "{shadow.sm}" }
        focus: { value: "0 0 0 3px {color.error.100}" }
        active: { value: "none" }

    # ローディング状態
    loading:
      opacity: { value: "0.7" }
      cursor: { value: "wait" }
      spinner:
        size: { value: "{spacing.4}" }
        color: { value: "currentColor" }
        animation: { value: "{interaction.animation.spin}" }

    # アイコンオンリーボタン
    iconOnly:
      size:
        small: { value: "{spacing.8}" }
        medium: { value: "{spacing.10}" }
        large: { value: "{spacing.12}" }
      padding: { value: "{spacing.0}" }
```

#### 使用例

```typescript
// ボタンコンポーネント
<button
  class="button button--primary button--medium"
  style={{
    height: 'var(--component-button-size-medium-height)',
    padding: 'var(--component-button-size-medium-padding-y) var(--component-button-size-medium-padding-x)',
    fontSize: 'var(--component-button-size-medium-font-size)',
    backgroundColor: 'var(--component-button-primary-background-default)',
    color: 'var(--component-button-primary-text-default)',
  }}
>
  <Icon size="var(--component-button-size-medium-icon-size)" />
  クリック
</button>
```

#### テスト
- [ ] 全てのバリアントが正しくレンダリング
- [ ] 全てのサイズが正しく適用
- [ ] 全ての状態がスムーズに遷移
- [ ] キーボードのフォーカスリングが表示
- [ ] ローディング状態がスピナーを表示
- [ ] アイコンオンリーボタンが正方形

---

### PR #12: Component/Input - 完全強化

**優先度:** 重要 (最も使用されるコンポーネント)
**見積もり工数:** 6時間
**破壊的変更:** なし

#### 提案される構造

```yaml
component:
  input:
    # サイズバリアント
    size:
      small:
        height: { value: "{spacing.8}" }
        paddingX: { value: "{spacing.3}" }
        paddingY: { value: "{spacing.2}" }
        fontSize: { value: "{font.size.sm}" }

      medium:
        height: { value: "{spacing.10}" }
        paddingX: { value: "{spacing.4}" }
        paddingY: { value: "{spacing.2.5}" }
        fontSize: { value: "{font.size.base}" }

      large:
        height: { value: "{spacing.12}" }
        paddingX: { value: "{spacing.6}" }
        paddingY: { value: "{spacing.3}" }
        fontSize: { value: "{font.size.lg}" }

    # 共通プロパティ
    fontWeight: { value: "{font.weight.normal}" }
    lineHeight: { value: "{font.lineHeight.normal}" }
    borderRadius: { value: "{border.radius.md}" }
    borderWidth: { value: "{border.width.1}" }

    # カラー
    background:
      default: { value: "{color.white}" }
      disabled: { value: "{color.gray.100}" }
      readonly: { value: "{color.gray.50}" }
      hover: { value: "{color.white}" }

    text:
      default: { value: "{color.gray.900}" }
      placeholder: { value: "{color.gray.400}" }
      disabled: { value: "{color.gray.500}" }

    border:
      default: { value: "{color.gray.300}" }
      hover: { value: "{color.gray.400}" }
      focus: { value: "{color.primary.500}" }
      focusError: { value: "{color.error.500}" }
      focusSuccess: { value: "{color.success.500}" }
      error: { value: "{color.error.500}" }
      success: { value: "{color.success.500}" }
      disabled: { value: "{color.gray.200}" }

    # フォーカスリング
    focusRing:
      width: { value: "3px" }
      offset: { value: "0" }
      color:
        default: { value: "{color.primary.100}" }
        error: { value: "{color.error.100}" }
        success: { value: "{color.success.100}" }

    # アイコン
    icon:
      size:
        small: { value: "{spacing.4}" }
        medium: { value: "{spacing.5}" }
        large: { value: "{spacing.6}" }
      color:
        default: { value: "{color.gray.500}" }
        error: { value: "{color.error.500}" }
        success: { value: "{color.success.500}" }
      spacing: { value: "{spacing.3}" }

    # ラベル
    label:
      fontSize: { value: "{font.size.sm}" }
      fontWeight: { value: "{font.weight.medium}" }
      color:
        default: { value: "{color.gray.700}" }
        disabled: { value: "{color.gray.400}" }
      spacing: { value: "{spacing.2}" }
      required:
        color: { value: "{color.error.500}" }

    # ヘルパーテキスト
    helper:
      fontSize: { value: "{font.size.sm}" }
      color:
        default: { value: "{color.gray.500}" }
        error: { value: "{color.error.600}" }
        success: { value: "{color.success.600}" }
      spacing: { value: "{spacing.1.5}" }

    # トランジション
    transition:
      duration: { value: "{animation.duration.fast}" }
      timing: { value: "{animation.easing.ease}" }
      properties: { value: "border-color, box-shadow, background-color" }
```

#### テスト
- [ ] 全てのサイズが正しくレンダリング
- [ ] エラー/成功状態が見える
- [ ] フォーカスリングが正しく表示
- [ ] アイコンが正しく配置
- [ ] ラベルとヘルパーテキストがスタイル適用

---

### PR #13: Component/Modal - ゼロから完成

**優先度:** 重要 (現在95%不完全)
**見積もり工数:** 8時間
**破壊的変更:** 完全な書き直し

#### 完全な構造

```yaml
component:
  modal:
    # 寸法
    width:
      small: { value: "400px", comment: "小さなモーダル（確認ダイアログなど）" }
      medium: { value: "600px", comment: "標準モーダル" }
      large: { value: "800px", comment: "大きなモーダル（フォームなど）" }
      xlarge: { value: "1000px", comment: "特大モーダル" }
      fullscreen: { value: "100vw", comment: "フルスクリーン" }

    maxHeight: { value: "90vh", comment: "画面高さの90%" }
    minHeight: { value: "200px" }

    # スペーシング
    padding:
      header: { value: "{spacing.6}" }
      body: { value: "{spacing.6}" }
      footer: { value: "{spacing.6}" }

    # カラー
    background:
      default: { value: "{surface.overlay.background}" }
      overlay: { value: "rgba(0, 0, 0, 0.5)" }

    # ボーダー
    border:
      width: { value: "{border.width.0}" }
      radius: { value: "{border.radius.lg}" }
      color: { value: "{color.border.default}" }

    # シャドウ
    shadow:
      default: { value: "{shadow.2xl}" }

    # Z-index
    zIndex:
      overlay: { value: "1000" }
      content: { value: "1001" }

    # アニメーション
    animation:
      enter:
        duration: { value: "{animation.duration.base}" }
        timing: { value: "{animation.easing.easeOut}" }
        overlay:
          from: { value: "opacity: 0" }
          to: { value: "opacity: 1" }
        content:
          from: { value: "opacity: 0; transform: scale(0.95) translateY(-20px)" }
          to: { value: "opacity: 1; transform: scale(1) translateY(0)" }

      exit:
        duration: { value: "{animation.duration.fast}" }
        timing: { value: "{animation.easing.easeIn}" }
        overlay:
          from: { value: "opacity: 1" }
          to: { value: "opacity: 0" }
        content:
          from: { value: "opacity: 1; transform: scale(1) translateY(0)" }
          to: { value: "opacity: 0; transform: scale(0.95) translateY(-20px)" }

    # ヘッダー
    header:
      background: { value: "transparent" }
      borderBottom: { value: "1px solid {color.border.default}" }
      padding: { value: "{component.modal.padding.header}" }

      title:
        fontSize: { value: "{font.size.xl}" }
        fontWeight: { value: "{font.weight.semibold}" }
        lineHeight: { value: "{font.lineHeight.tight}" }
        color: { value: "{color.foreground.primary}" }

      subtitle:
        fontSize: { value: "{font.size.sm}" }
        fontWeight: { value: "{font.weight.normal}" }
        lineHeight: { value: "{font.lineHeight.normal}" }
        color: { value: "{color.foreground.secondary}" }
        marginTop: { value: "{spacing.1}" }

    # ボディ
    body:
      padding: { value: "{component.modal.padding.body}" }
      maxHeight: { value: "60vh" }
      overflow: { value: "auto" }

    # フッター
    footer:
      background: { value: "{surface.raised.background}" }
      borderTop: { value: "1px solid {color.border.default}" }
      padding: { value: "{component.modal.padding.footer}" }
      gap: { value: "{spacing.3}" }
      justifyContent: { value: "flex-end" }

    # 閉じるボタン
    closeButton:
      size: { value: "{spacing.8}" }
      position:
        top: { value: "{spacing.4}" }
        right: { value: "{spacing.4}" }
      background:
        default: { value: "transparent" }
        hover: { value: "{surface.interactive.hover.background}" }
        active: { value: "{surface.interactive.active.background}" }
      color:
        default: { value: "{color.foreground.secondary}" }
        hover: { value: "{color.foreground.primary}" }
      borderRadius: { value: "{border.radius.md}" }
      transition:
        duration: { value: "{animation.duration.fast}" }
        timing: { value: "{animation.easing.ease}" }

    # オーバーレイ
    overlay:
      backdropFilter: { value: "blur(2px)" }
```

#### テスト
- [ ] 全てのサイズが正しく動作
- [ ] アニメーションがスムーズ
- [ ] オーバーレイがインタラクションをブロック
- [ ] 閉じるボタンが機能
- [ ] ヘッダー/フッターセクションがスタイル適用
- [ ] スクロール動作が正しい

---

### PR #14-19: 残りのコンポーネント

同様のパターンに従って:

- **PR #14:** Component/Tooltip - ゼロから完成 (6時間)
- **PR #15:** Component/Card - 欠落しているトークンを追加 (5時間)
- **PR #16:** Component/Badge - サイズとアイコンを追加 (4時間)
- **PR #17:** Component/Alert - 閉じるボタンを追加 (4時間)
- **PR #18:** Component/Table - 完全な構造 (6時間)
- **PR #19:** Component/Navigation - 完全な構造 (6時間)

---

## フェーズ4: 高度な機能 (第14-19週)

### PR #20: アクセシビリティトークン

**優先度:** 高
**見積もり工数:** 6時間

以下の包括的なアクセシビリティトークンを追加:
- ハイコントラストモード
- タッチターゲット
- フォーカスインジケーター
- スクリーンリーダー固有のトークン

---

### PR #21: 完全なモーションシステム

**優先度:** 中
**見積もり工数:** 8時間

全てのアニメーションキーフレームと完全なアニメーションシステムを追加。

---

### PR #22: プラットフォーム出力 (SCSS, iOS, Android)

**優先度:** 低
**見積もり工数:** 12時間

追加プラットフォーム用のビルド出力を追加。

---

## まとめ

**総PR数:** 22
**総見積もり工数:** 約138時間
**見積もりタイムライン:** 16-19週間

### クリティカルパス
1. 基盤修正 (PRs #1-4): **2週間**
2. ボタン & 入力 (PRs #11-12): **2週間**
3. モーダル & ツールチップ (PRs #13-14): **2週間**
4. 残りのコンポーネント (PRs #15-19): **5週間**

**最小限の実行可能な完成:** 11週間 (基盤 + 重要なコンポーネント)

---

## 次のステップ

1. この計画をレビューして承認
2. 各PRのGitHubイシューを作成
3. プロジェクトボードを設定
4. チームメンバーをアサイン
5. PR #1から開始

---

**リファクタリング計画終了**
